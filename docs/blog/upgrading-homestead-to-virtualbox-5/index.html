<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="description" content="How to upgrade Homestead to work with Virtualbox 5.">

        <meta property="og:site_name" content="GeneaLabs"/>
        <meta property="og:title" content="Upgrading Homestead to VirtualBox 5 | GeneaLabs"/>
        <meta property="og:description" content="How to upgrade Homestead to work with Virtualbox 5."/>
        <meta property="og:url" content="https://genealabs.com/blog/upgrading-homestead-to-virtualbox-5"/>
        <meta property="og:image" content="/assets/images/logo.png"/>
        <meta property="og:type" content="website"/>

        <meta name="twitter:image:alt" content="GeneaLabs">
        <meta name="twitter:card" content="summary_large_image">

        
        <title>GeneaLabs | Upgrading Homestead to VirtualBox 5</title>

        <link rel="home" href="https://genealabs.com">
        <link rel="icon" href="/favicon.ico">

            <meta property="og:title" content="Upgrading Homestead to VirtualBox 5" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://genealabs.com/blog/upgrading-homestead-to-virtualbox-5"/>
    <meta property="og:description" content="How to upgrade Homestead to work with Virtualbox 5." />

                    <!-- Insert analytics code here -->
        
        <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,300i,400,400i,700,700i,800,800i" rel="stylesheet">
        <link rel="stylesheet" href="/assets/build/css/main.css?id=f67c1c93de4c60db0508">

        
            </head>

    <body class="flex flex-col justify-between min-h-screen bg-gray-100 text-gray-900 leading-normal font-sans">
        <div id="app">
            <header class="flex items-center shadow bg-white border-b h-24 py-4" role="banner">
                <div class="container flex items-center mx-auto px-4 lg:px-8">
                    <div class="flex items-center">
                        <a href="/" title="GeneaLabs home" class="inline-flex items-center">
                            <img class="h-8 md:h-10 mr-3" src="/assets/images/genealabs_logo_new.png" alt="GeneaLabs logo" />
                        </a>
                    </div>

                        <div id="vue-search" class="flex flex-1 justify-end items-center">
        <search></search>

        <nav class="hidden lg:flex items-center justify-end text-lg">
            <a href="/blog"
            class="text-green-600 hover:text-green-900 lvl0   ml-6 "
        >
            Blog
        </a>
    
                <a href="/packages"
            class="text-green-600 hover:text-green-900 lvl0   ml-6 "
        >
            Packages
        </a>
    
                <a href="/about"
            class="text-green-600 hover:text-green-900 lvl0   ml-6 "
        >
            About
        </a>
    
                <a href="/contact"
            class="text-green-600 hover:text-green-900 lvl0   ml-6 "
        >
            Contact
        </a>
    
        </nav>

        <button class="flex justify-center items-center bg-blue-500 border border-blue h-10 mr-4 px-5 rounded-full lg:hidden focus:outline-none"
    onclick="navMenu.toggle()"
>
    <svg id="js-nav-menu-show" xmlns="http://www.w3.org/2000/svg"
        class="fill-current text-white h-9 w-4" viewBox="0 0 32 32"
    >
        <path d="M4,10h24c1.104,0,2-0.896,2-2s-0.896-2-2-2H4C2.896,6,2,6.896,2,8S2.896,10,4,10z M28,14H4c-1.104,0-2,0.896-2,2  s0.896,2,2,2h24c1.104,0,2-0.896,2-2S29.104,14,28,14z M28,22H4c-1.104,0-2,0.896-2,2s0.896,2,2,2h24c1.104,0,2-0.896,2-2  S29.104,22,28,22z"/>
    </svg>

    <svg id="js-nav-menu-hide" xmlns="http://www.w3.org/2000/svg"
        class="hidden fill-current text-white h-9 w-4" viewBox="0 0 36 30"
    >
        <polygon points="32.8,4.4 28.6,0.2 18,10.8 7.4,0.2 3.2,4.4 13.8,15 3.2,25.6 7.4,29.8 18,19.2 28.6,29.8 32.8,25.6 22.2,15 "/>
    </svg>
</button>

    </div>

                </div>

                    <button class="flex justify-center items-center bg-blue-500 border border-blue h-10 mr-4 px-5 rounded-full lg:hidden focus:outline-none"
    onclick="navMenu.toggle()"
>
    <svg id="js-nav-menu-show" xmlns="http://www.w3.org/2000/svg"
        class="fill-current text-white h-9 w-4" viewBox="0 0 32 32"
    >
        <path d="M4,10h24c1.104,0,2-0.896,2-2s-0.896-2-2-2H4C2.896,6,2,6.896,2,8S2.896,10,4,10z M28,14H4c-1.104,0-2,0.896-2,2  s0.896,2,2,2h24c1.104,0,2-0.896,2-2S29.104,14,28,14z M28,22H4c-1.104,0-2,0.896-2,2s0.896,2,2,2h24c1.104,0,2-0.896,2-2  S29.104,22,28,22z"/>
    </svg>

    <svg id="js-nav-menu-hide" xmlns="http://www.w3.org/2000/svg"
        class="hidden fill-current text-white h-9 w-4" viewBox="0 0 36 30"
    >
        <polygon points="32.8,4.4 28.6,0.2 18,10.8 7.4,0.2 3.2,4.4 13.8,15 3.2,25.6 7.4,29.8 18,19.2 28.6,29.8 32.8,25.6 22.2,15 "/>
    </svg>
</button>

            </header>

            <main role="main"
                class="w-full flex-auto relative"
            >
                    <section class="flex-auto w-full container mx-auto py-16 px-6">
        
        <h1 class="leading-none mb-2">Upgrading Homestead to VirtualBox 5</h1>

        <p class="text-gray-800 text-xl md:mt-0">Mike Bronner  ‚Ä¢  October 5, 2017</p>

                                    <a
                    href="/blog/categories/homestead"
                    title="View posts in homestead"
                    class="inline-block bg-gray-300 hover:bg-blue-500-lighter leading-loose tracking-wide text-gray-900 uppercase text-xs font-semibold rounded mr-4 px-3 pt-px"
                >homestead</a>
                    
        <div class="border-b border-blue-200 mb-10 pb-4" v-pre>
            <hr />

<p><em>Note on conventions used in this article:
- console commands are bold and italic:</em> <strong><em>which php5-fpm</em></strong></p>

<hr />

<h3>Reasoning</h3>

<p>As with everything, we need to make a consious decision when we do things. In this case a VirtualBox Guest Additions mismatch has severe performance implications and in my case has halted the synchronizing between Vagrant and OS/X.</p>

<hr />

<h3>Requirements</h3>

<ul>
<li>Homestead 2</li>
<li>VirtualBox 5 (5.0.0 or greater)</li>
<li>Vagrant 1.7.4 (or greater)</li>
</ul>

<hr />

<h3>Implementation</h3>

<ol>
<li>Let‚Äôs start off by halting Homestead:
<strong><em>homestead halt</em></strong></li>
<li>And next Vagrant: make sure you download the <a href="http://www.vagrantup.com/downloads.html">latest version</a> (1.7.4 as of this writing) and install as usual.</li>
<li>Download and install the <a href="https://www.virtualbox.org/wiki/Downloads">latest version of VirtualBox</a> (5.0.0 as of this writing).</li>
<li>Now for the tricky bit: upgrading VirtualBox Guest Additions. Let‚Äôs bring Homestead back up:
<strong><em>homestead up</em></strong> Notice now how it says the Guest Addition version does not match the VirtualBox version?</li>
<li>SSH into Homestead:
<strong><em>homestead ssh</em></strong></li>
<li>Remove any existing packages that we need to build the Guest Additions. (We will install the new versions next.)
<strong><em>sudo apt-get remove dkms build-essential linux-headers-*</em></strong></li>
<li>Remove any remnants of the old Guest Additions:
<strong><em>sudo rm -rf VBoxGuestAdditions-*</em></strong></li>
<li>Now lets install the new replacements for them:
<strong><em>sudo apt-get install dkms build-essential linux-headers-$(uname -r)</em></strong></li>
<li>Great! We have the system prepped, and ready to install the new Guest Additions. In my example I am using the 5.0.0 version, but make sure you use the version that matches your VirtualBox (one command, please excuse the inappropriate line breaks‚Ää‚Äî‚Ääwish Medium had propper code snippet support, the code blocks they do have break the lists):
<strong><em>wget</em></strong> <a href="http://download.virtualbox.org/virtualbox/5.0.0/VBoxGuestAdditions_5.0.0.iso"><strong><em>http://download.virtualbox.org/virtualbox/5.0.0/VBoxGuestAdditions_5.0.0.iso</em></strong></a></li>
<li>Create a mount point for the ISO:
<strong><em>sudo mkdir /media/VBoxGuestAdditions</em></strong></li>
<li>And mount the ISO (again, this is a single command on one line):
<strong><em>sudo mount -o loop,ro VBoxGuestAdditions_5.0.0.iso /media/VBoxGuestAdditions</em></strong></li>
<li>Now we can finally install the Guest Additions:
<strong><em>sudo sh /media/VBoxGuestAdditions/VBoxLinuxAdditions.run</em></strong></li>
<li>Once this completes successfully, we can clean up:
<strong><em>sudo umount /media/VBoxGuestAdditions
sudo rm -rf /media/VBoxGuestAdditions
rm VBoxGuestAdditions</em><em>.iso
sudo rm -rf /opt/VBoxGuestAdditions-4</em>_</strong></li>
<li>Exit out of Homestead, and restart it:
<strong><em>exit
homestead halt</em></strong></li>
<li>Let‚Äôs bring it back up:
<strong><em>homestead up</em></strong></li>
</ol>

<hr />

<p>And we can rejoice not seeing a Guest Addition version warning! Mission accomplished. Now pat yourself on the back, and get back to work already! üòÑ</p>

<hr />

<h3>Update</h3>

<p>This process also fixes instances of the following error that may be encountered while running <strong><em>homestead up</em></strong>:</p>

<pre><code>==&gt; default: Mounting shared folders‚Ä¶
default: /vagrant =&gt; /Users/mike/.composer/vendor/laravel/homestead
Failed to mount folders in Linux guest. This is usually because
the ‚Äúvboxsf‚Äù file system is not available. Please verify that
the guest additions are properly installed in the guest and
can work properly. The command attempted was:
</code></pre>

<pre><code>mount -t vboxsf -o uid=`id -u vagrant`,gid=`getent group vagrant | cut -d: -f3` vagrant /vagrant
mount -t vboxsf -o uid=`id -u vagrant`,gid=`id -g vagrant` vagrant /vagrant
</code></pre>

<pre><code>The error output from the last command was:
</code></pre>

<pre><code>mount: wrong fs type, bad option, bad superblock on vagrant,
missing codepage or helper program, or other error
</code></pre>

<pre><code>In some cases useful info is found in syslog ‚Äî try
dmesg | tail or so.
</code></pre>
        </div>

        <nav class="flex justify-between text-sm md:text-base">
            <div>
                                    <a href="https://genealabs.com/blog/creating-packages-with-laravel-5-and-studio" title="Older Post: Creating Packages with Laravel 5 &amp; Studio">
                        &LeftArrow; Creating Packages with Laravel 5 &amp; Studio
                    </a>
                            </div>

            <div>
                                    <a href="https://genealabs.com/blog/how-do-you-find-the-right-translator" title="Newer Post: How do you find the right translator?">
                        How do you find the right translator? &RightArrow;
                    </a>
                            </div>
        </nav>
    </section>
            </main>
        </div>

        <script src="/assets/build/js/main.js?id=935fee3fd4580ec9a745"></script>

        <script>
    const navMenu = {
        toggle() {
            let menu = document.getElementById('js-nav-menu');
            menu.classList.toggle('hidden');
            menu.classList.toggle('lg:block');
            document.getElementById('js-nav-menu-hide').classList.toggle('hidden');
            document.getElementById('js-nav-menu-show').classList.toggle('hidden');
            console.log(document.getElementById('js-nav-menu2'));
            //document.querySelector("js-nav-menu")
/*
            const menu2 = document.getElementById('js-nav-menu2');
            menu.classList.toggle('hidden');
            menu.classList.toggle('lg:block');
            document.getElementById('js-nav-menu-hide').classList.toggle('hidden');
            document.getElementById('js-nav-menu-show').classList.toggle('hidden');
            */
        },
    }
</script>
<script>
    const navMenu = {
        toggle() {
            let menu = document.getElementById('js-nav-menu');
            menu.classList.toggle('hidden');
            menu.classList.toggle('lg:block');
            document.getElementById('js-nav-menu-hide').classList.toggle('hidden');
            document.getElementById('js-nav-menu-show').classList.toggle('hidden');
            console.log(document.getElementById('js-nav-menu2'));
            //document.querySelector("js-nav-menu")
/*
            const menu2 = document.getElementById('js-nav-menu2');
            menu.classList.toggle('hidden');
            menu.classList.toggle('lg:block');
            document.getElementById('js-nav-menu-hide').classList.toggle('hidden');
            document.getElementById('js-nav-menu-show').classList.toggle('hidden');
            */
        },
    }
</script>

        <footer class="bg-white text-center text-sm py-4" role="contentinfo">
            <ul class="flex flex-col md:flex-row justify-center list-reset">
                <li class="md:mr-2">
                    &copy;
                    <a
                        class="text-green-600 hover:text-green-900"
                        href="https://genealabs.com"
                        title="GeneaLabs website"
                    >GeneaLabs</a>
                    2014 - 2020.
                </li>
                <li class="md:mr-2">
                    <a
                        class="text-green-600 hover:text-green-900"
                        href="https://genealabs.com/privacy-policy"
                        title="Privacy Policy"
                    >Privacy Policy</a>
                </li>
                <li class="md:mr-2">
                    <a
                        class="text-green-600 hover:text-green-900"
                        href="https://genealabs.com/terms-of-service"
                        title="Terms of Service"
                    >Terms of Service</a>
                </li>
                <li class="md:mr-2">
                    <a
                        class="text-green-600 hover:text-green-900"
                        href="https://genealabs.com/disclaimer"
                        title="Disclaimer"
                    >Disclaimer</a>
                </li>
            </ul>
        </footer>
    </body>
</html>
