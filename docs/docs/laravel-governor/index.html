<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="description" content="Building a navigation menu for your site">

        <meta property="og:site_name" content=""/>
        <meta property="og:title" content="Governor for Laravel | "/>
        <meta property="og:description" content="Building a navigation menu for your site"/>
        <meta property="og:url" content="https://genealabs.com/docs/laravel-governor"/>
        <meta property="og:image" content="/assets/images/logo.png"/>
        <meta property="og:type" content="website"/>

        <meta name="twitter:image:alt" content="">
        <meta name="twitter:card" content="summary_large_image">

        
        <title> | Governor for Laravel</title>

        <link rel="home" href="https://genealabs.com">
        <link rel="icon" href="/favicon.ico">

        
                    <!-- Insert analytics code here -->
        
        <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,300i,400,400i,700,700i,800,800i" rel="stylesheet">
        <link rel="stylesheet" href="/assets/build/css/main.css?id=40cc8caa93df6728430d">

        
            </head>

    <body class="flex flex-col justify-between min-h-screen bg-grey-lightest text-grey-darkest leading-normal font-sans">
        <div id="app">
            <header class="flex items-center shadow bg-white border-b h-24 mb-8 py-4" role="banner">
                <div class="container flex items-center max-w-4xl mx-auto px-4 lg:px-8">
                    <div class="flex items-center">
                        <a href="/" title=" home" class="inline-flex items-center">
                            <img class="h-8 md:h-10 mr-3" src="/assets/images/genealabs_logo_new.png" alt=" logo" />

                            <h1 class="text-lg md:text-2xl text-blue-darkest font-semibold hover:text-blue-dark my-0 pr-4"></h1>
                        </a>
                    </div>

                        <div class="flex flex-1 justify-end items-center text-right md:pl-10">
        
        <nav class="hidden lg:flex items-center justify-end text-lg">
            <a href="/blog"
            class="lvl0   ml-6 "
        >
            Blog
        </a>
    
                <a href="/packages"
            class="lvl0   ml-6 "
        >
            Packages
        </a>
    
                <a href="/about"
            class="lvl0   ml-6 "
        >
            About
        </a>
    
                <a href="/contact"
            class="lvl0   ml-6 "
        >
            Contact
        </a>
    
        </nav>
    </div>

                </div>

                    <button class="flex justify-center items-center bg-blue border border-blue h-10 mr-4 px-5 rounded-full lg:hidden focus:outline-none"
    onclick="navMenu.toggle()"
>
    <svg id="js-nav-menu-show" xmlns="http://www.w3.org/2000/svg"
        class="fill-current text-white h-9 w-4" viewBox="0 0 32 32"
    >
        <path d="M4,10h24c1.104,0,2-0.896,2-2s-0.896-2-2-2H4C2.896,6,2,6.896,2,8S2.896,10,4,10z M28,14H4c-1.104,0-2,0.896-2,2  s0.896,2,2,2h24c1.104,0,2-0.896,2-2S29.104,14,28,14z M28,22H4c-1.104,0-2,0.896-2,2s0.896,2,2,2h24c1.104,0,2-0.896,2-2  S29.104,22,28,22z"/>
    </svg>

    <svg id="js-nav-menu-hide" xmlns="http://www.w3.org/2000/svg"
        class="hidden fill-current text-white h-9 w-4" viewBox="0 0 36 30"
    >
        <polygon points="32.8,4.4 28.6,0.2 18,10.8 7.4,0.2 3.2,4.4 13.8,15 3.2,25.6 7.4,29.8 18,19.2 28.6,29.8 32.8,25.6 22.2,15 "/>
    </svg>
</button>

            </header>

            <main role="main"
                class="w-full flex-auto relative"
            >
                    <section class="container max-w-4xl mx-auto px-6 md:px-8 py-4">
        <div class="flex flex-col lg:flex-row">
            <nav id="js-nav-menu" class="nav-menu hidden lg:block">
                <ul class="list-reset my-0">
            <li class="list-reset pl-4">
            
        <a href="/packages"
            class="lvl0 lvl0-active  nav-menu__item hover:text-blue"
        >
            Packages
        </a>
    
            
        <ul class="list-reset my-0">
            <li class="list-reset pl-4">
            
        <a href="/docs/laravel-model-caching"
            class="lvl1   nav-menu__item hover:text-blue"
        >
            Model Caching for Laravel
        </a>
    
    </li>
            <li class="list-reset pl-4">
            
        <a href="/docs/laravel-caffeine"
            class="lvl1   nav-menu__item hover:text-blue"
        >
            Caffeine for Laravel
        </a>
    
    </li>
            <li class="list-reset pl-4">
            
        <a href="/docs/laravel-governor"
            class="lvl1  active font-semibold text-blue nav-menu__item hover:text-blue"
        >
            Governor for Laravel
        </a>
    
    </li>
    </ul>
    </li>
    </ul>
            </nav>

            <div class="w-full lg:w-3/5 break-words pb-16 lg:pl-4" v-pre>
                <p><img src="/assets/images/governor.jpg" alt="Governor for Laravel" /></p>
<h1>Governor For Laravel</h1>
<p><a href="https://travis-ci.org/GeneaLabs/laravel-governor"><img src="https://travis-ci.org/GeneaLabs/laravel-governor.svg?branch=master" alt="Build Status" /></a>
<a href="https://coveralls.io/github/GeneaLabs/laravel-governor?branch=master"><img src="https://coveralls.io/repos/github/GeneaLabs/laravel-governor/badge.svg?branch=master" alt="Coverage Status" /></a>
<a href="https://packagist.org/packages/genealabs/laravel-governor"><img src="https://poser.pugx.org/genealabs/laravel-governor/v/stable.png" alt="Latest StableVersion" /></a>
<a href="https://packagist.org/packages/genealabs/laravel-governor"><img src="https://poser.pugx.org/genealabs/laravel-governor/downloads.png" alt="Total Downloads" /></a></p>
<p><strong>Manage authorization with granular role-based permissions in your Laravel apps.</strong></p>
<p><img src="https://cloud.githubusercontent.com/assets/1791050/26765962/fa085878-493b-11e7-9bb7-b4d9f88844a0.gif" alt="screencast 2017-06-04 at 3 34 56 pm" /></p>
<h2>Goal</h2>
<p>Provide a simple method of managing ACL in a Laravel application built on the
Laravel Authorization functionality. By leveraging Laravel's native
Authorization functionality there is no additional learning or implementation
curve. All you need to know is Laravel, and you will know how to use Governor
for Laravel.</p>
<h2>Requirements</h2>
<ul>
<li>PHP &gt;=7.1.3</li>
<li>Laravel &gt;= 5.5</li>
<li>Bootstrap 3 (needs to be included in your layout file)</li>
<li>FontAwesome 4 (needs to be included in your layout file)</li>
</ul>
<h2>Installation</h2>
<p>The user with the lowest primary key will be set up as the SuperAdmin. If you're
starting on a new project, be sure to add an initial user now. If you already
have users, you can update the role-user entry to point to your intended user,
if the first user is not the intended SuperAdmin. Now let's get the package
installed.</p>
<p>Install via composer:</p>
<pre><code class="language-sh">composer require genealabs/laravel-governor</code></pre>
<h2>Implementation</h2>
<ol>
<li>
<p>First we need to update the database by running the migrations and data seeders:</p>
<pre><code class="language-sh">php artisan migrate --path="vendor/genealabs/laravel-governor/database/migrations"
php artisan db:seed --class=LaravelGovernorDatabaseSeeder</code></pre>
</li>
<li>
<p>If you have seeders of your own, run them now:</p>
<pre><code class="language-sh">php artisan db:seed</code></pre>
</li>
<li>
<p>Next, assign permissions (this requires you have users already populated):</p>
<pre><code class="language-sh">php artisan db:seed --class=LaravelGovernorPermissionsTableSeeder</code></pre>
</li>
<li>
<p>Now we need to make the assets available:</p>
<pre><code class="language-sh">php artisan governor:publish --assets</code></pre>
</li>
<li>
<p>Lastly, add the Governable trait to the User model of your app:</p>
<pre><code class="language-php">// [...]
use GeneaLabs\LaravelGovernor\Traits\Governable;

class User extends Authenticatable
{
    use Governable;
    // [...]
}</code></pre>
</li>
</ol>
<h2>Upgrading</h2>
<p>The following upgrade guides should help navigate updates with breaking changes.</p>
<h3>From 0.11.5+ to 0.12 [Breaking]</h3>
<p>The role_user pivot table has replaced the composite key with a primary key, as Laravel does not fully support composite keys. Run:</p>
<pre><code class="language-sh">php artisan db:seed --class="LaravelGovernorUpgradeTo0120"</code></pre>
<h3>From 0.11 to 0.11.5 [Breaking]</h3>
<p>The primary keys of the package's tables have been renamed. (This should have been a minor version change, instead of a patch, as this was a breaking change.) Run:</p>
<pre><code class="language-sh">php artisan db:seed --class="LaravelGovernorUpgradeTo0115"</code></pre>
<h3>From 0.10 to 0.11 [Breaking]</h3>
<p>The following traits have changed:</p>
<ul>
<li><code>Governable</code> has been renamed to <code>Governing</code>.</li>
<li><code>Governed</code> has been renamed to <code>Governable</code>.</li>
<li>the <code>governor_created_by</code> has been renamed to <code>governor_owned_by</code>. Run migrations to update your tables.
<pre><code class="language-sh">php artisan db:seed --class="LaravelGovernorUpgradeTo0110"</code></pre></li>
<li>replace any reference in your app from <code>governor_created_by</code> to
<code>governor_owned_by</code>.</li>
</ul>
<h3>From 0.6 to Version 0.10 [Breaking]</h3>
<p>To upgrade from version previous to <code>0.10.0</code>, first run the migrations and
seeders, then run the update seeder:</p>
<pre><code class="language-sh">php artisan migrate --path="vendor/genealabs/laravel-governor/database/migrations"
php artisan db:seed --class="LaravelGovernorDatabaseSeeder"
php artisan db:seed --class="LaravelGovernorUpgradeTo0100"</code></pre>
<h3>to 0.6 [Breaking]</h3>
<ol>
<li>If you were extending <code>GeneaLabs\LaravelGovernor\Policies\LaravelGovernorPolicy</code>,
change to extend <code>GeneaLabs\LaravelGovernor\Policies\BasePolicy</code>;</li>
<li>Support for version of Laravel lower than 5.5 has been dropped.</li>
</ol>
<h2>Configuration</h2>
<p>If you need to make any changes (see Example selection below for the default
config file) to the default configuration, publish the configuration file:</p>
<pre><code class="language-sh">php artisan governor:publish --config</code></pre>
<p>and make any necessary changes. (We don't recommend publishing the config file
if you don't need to make any changes.)</p>
<h3>Views</h3>
<p>If you would like to customize the views, publish them:</p>
<pre><code class="language-sh">php artisan governor:publish --views</code></pre>
<p>and edit them in <code>resources\views\vendor\genealabs\laravel-governor</code>.</p>
<h3>Policies</h3>
<p>Policies are now auto-detected and automatically added to the entities list. You
will no longer need to manage Entities manually. New policies will be available
for role assignment when editing roles. Check out the example policy in
the Examples section below. See Laravel's documentation on how to create
policies and check for them in code:
<a href="https://laravel.com/docs/5.4/authorization#writing-policies">https://laravel.com/docs/5.4/authorization#writing-policies</a></p>
<p><strong>Your policies must extend LaravelGovernorPolicy in order to function with
Governor.</strong> By default you do not need to include any of the methods, as they
are implemented automatically and perform checks based on reflection. However,
if you need to customize anything, you are free to override any of the <code>before</code>,
<code>create</code>, <code>edit</code>, <code>view</code>, <code>inspect</code>, and <code>remove</code> methods.</p>
<h4>Checking Authorization</h4>
<p>To validate a user against a given policy, use one of the keywords that Governor
validates against: <code>before</code>, <code>create</code>, <code>edit</code>, <code>view</code>, <code>inspect</code>, and <code>remove</code>.
For example, if the desired policy to check has a class name of <code>BlogPostPolicy</code>,
you would authorize your user with something like <code>$user-&gt;can('create', (new BlogPost))</code>
or <code>$user-&gt;can('edit', $blogPost)</code>.</p>
<h3>Filter Queries To Show Ownly Allowed Items</h3>
<p>Often it is desirable to let the user see only the items that they have access
to. This was previously difficult and tedious. Using Nova as an example, you
can now limit the index view as follows:</p>
<pre><code class="language-php">    &lt;?php namespace App\Nova;

    use Laravel\Nova\Resource as NovaResource;
    use Laravel\Nova\Http\Requests\NovaRequest;

    abstract class Resource extends NovaResource
    {
        public static function indexQuery(NovaRequest $request, $query)
        {
            $model = $query-&gt;getModel();

            if ($model
                &amp;&amp; is_object($model)
                &amp;&amp; method_exists($model, "filterViewAnyable")
            ) {
                $query = $model-&gt;filterViewAnyable($query);
            }

            return $query;
        }

        // ...
    }</code></pre>
<pre><code>The available query filters are:
- `filterDeletable(Builder $query)`
- `filterUpdatable(Builder $query)`
- `filterViewable(Builder $query)`
- `filterViewAnyable(Builder $query)`

The same functionality is availabe via model scopes, as well:
- `deletable()`
- `updatable()`
- `viewable()`
- `viewAnyable()`</code></pre>
<h3>Tables</h3>
<p>Tables will automatically be updated with a <code>governor_owned_by</code> column that references
the user that created the entry. There is no more need to run separate
migrations or work around packages that have models without a created_by
property.</p>
<h3>Admin Views</h3>
<p>The easiest way to integrate Governor for Laravel into your app is to add the
menu items to the relevant section of your app's menu (make sure to restrict
access appropriately using the Laravel Authorization methods). The following
routes can be added:</p>
<ul>
<li>Role Management: <code>genealabs.laravel-governor.roles.index</code></li>
<li>User-Role Assignments: <code>genealabs.laravel-governor.assignments.index</code></li>
</ul>
<p>For example:</p>
<pre><code class="language-php">&lt;li&gt;&lt;a href="{{ route('genealabs.laravel-governor.roles.index') }}"&gt;Governor&lt;/a&gt;&lt;/li&gt;</code></pre>
<h3>403 Unauthorized</h3>
<p>We recommend making a custom 403 error page to let the user know they don't have
access. Otherwise the user will just see the default error message. See
<a href="https://laravel.com/docs/5.4/errors#custom-http-error-pages">https://laravel.com/docs/5.4/errors#custom-http-error-pages</a> for more details on
how to set those up.</p>
<h3>Authorization API</h3>
<p>You can check a user's ability to perform certain actions via a public API. It
is recommended to use Laravel Passport to maintain session state between your
client and your backend. Here's an example that checks if the currently logged
in user can create <code>GeneaLabs\LaravelGovernor\Role</code> model records:</p>
<pre><code class="language-php">$response = $this
    -&gt;json(
        "GET",
        route('genealabs.laravel-governor.api.user-can.show', "create"),
        [
            "model" =&gt; "GeneaLabs\LaravelGovernor\Role",
        ]
    );</code></pre>
<p>This next example checks if the user can edit <code>GeneaLabs\LaravelGovernor\Role</code>
model records:</p>
<pre><code class="language-php">$response = $this
    -&gt;json(
        "GET",
        route('genealabs.laravel-governor.api.user-can.show', "edit"),
        [
            "model" =&gt; "GeneaLabs\LaravelGovernor\Role",
            "primary-key" =&gt; 1,
        ]
    );</code></pre>
<p>The abilities <code>inspect</code>, <code>edit</code>, and <code>remove</code>, except <code>create</code> and <code>view</code>,
require the primary key to be passed.</p>
<h3>Role-Check API</h3>
<p>// TODO: add documentation</p>
<pre><code class="language-php">$response = $this
    -&gt;json(
        "GET",
        route('genealabs.laravel-governor.api.user-is.show', "SuperAdmin")
    );</code></pre>
<h2>Examples</h2>
<h3>Config File</h3>
<pre><code class="language-php">&lt;?php

return [

    /*
    |--------------------------------------------------------------------------
    | Layout Blade File
    |--------------------------------------------------------------------------
    |
    | This value is used to reference your main layout blade view to render
    | the views provided by this package. The layout view referenced here
    | should include Bootstrap 3 and FontAwesome 4 to work as intended.
    */
    'layout-view' =&gt; 'layouts.app',

    /*
    |--------------------------------------------------------------------------
    | Layout Content Section Name
    |--------------------------------------------------------------------------
    |
    | Specify the name of the section in the view referenced above that is
    | used to render the main page content. If this does not match, you
    | will only get blank pages when accessing views in Governor.
    */
    'content-section' =&gt; 'content',

    /*
    |--------------------------------------------------------------------------
    | Authorization Model
    |--------------------------------------------------------------------------
    |
    | Here you can customize what model should be used for authorization checks
    | in the event that you have customized your authentication processes.
    */
    'auth-model' =&gt; config('auth.providers.users.model') ?? config('auth.model'),

    /*
    |--------------------------------------------------------------------------
    | User Model Name Property
    |--------------------------------------------------------------------------
    |
    | This value is used to display your users when assigning them to roles.
    | You can choose any property of your auth-model defined above that is
    | exposed via JSON.
    */
    'user-name-property' =&gt; 'name',

    /*
    |--------------------------------------------------------------------------
    | URL Prefix
    |--------------------------------------------------------------------------
    |
    | If you want to change the URL used by the browser to access the admin
    | pages, you can do so here. Be careful to avoid collisions with any
    | existing URLs of your app when doing so.
    */
    'url-prefix' =&gt; '/genealabs/laravel-governor/',
];</code></pre>
<h3>Policy</h3>
<h4>No Methods Required For Default Policies</h4>
<p>Adding policies is crazily simple! All the work has been refactored out so all
you need to worry about now is creating a policy class, and that's it!</p>
<pre><code class="language-php">&lt;?php namespace GeneaLabs\LaravelGovernor\Policies;

use GeneaLabs\LaravelGovernor\Interfaces\GovernablePolicy;
use Illuminate\Auth\Access\HandlesAuthorization;

class MyPolicy extends LaravelGovernorPolicy
{
    use HandlesAuthorization;
}</code></pre>
<h4>Default Methods In A Policy Class</h4>
<p>Adding any of the <code>before</code>, <code>create</code>, <code>update</code>, <code>view</code>, <code>viewAny</code>, <code>delete</code>,
<code>restore</code>, and <code>forceDelete</code> methods to your policy is only required if you want
to customize a given method.</p>
<pre><code class="language-php">abstract class BasePolicy
{
    public function before($user)
    {
        return $user-&gt;hasRole("SuperAdmin")
            ?: null;
    }

    public function create(Model $user) : bool
    {
        return $this-&gt;validatePermissions(
            $user,
            'create',
            $this-&gt;entity
        );
    }

    public function update(Model $user, Model $model) : bool
    {
        return $this-&gt;validatePermissions(
            $user,
            'update',
            $this-&gt;entity,
            $model-&gt;governor_owned_by
        );
    }

    public function viewAny(Model $user) : bool
    {
        return true;

        return $this-&gt;validatePermissions(
            $user,
            'viewAny',
            $this-&gt;entity
        );
    }

    public function view(Model $user, Model $model) : bool
    {
        return $this-&gt;validatePermissions(
            $user,
            'view',
            $this-&gt;entity,
            $model-&gt;governor_owned_by
        );
    }

    public function delete(Model $user, Model $model) : bool
    {
        return $this-&gt;validatePermissions(
            $user,
            'delete',
            $this-&gt;entity,
            $model-&gt;governor_owned_by
        );
    }

    public function restore(Model $user, Model $model) : bool
    {
        return $this-&gt;validatePermissions(
            $user,
            'restore',
            $this-&gt;entity,
            $model-&gt;governor_owned_by
        );
    }

    public function forceDelete(Model $user, Model $model) : bool
    {
        return $this-&gt;validatePermissions(
            $user,
            'forceDelete',
            $this-&gt;entity,
            $model-&gt;governor_owned_by
        );
    }
}</code></pre>            </div>
        </div>
    </section>
            </main>
        </div>

        <script src="/assets/build/js/main.js?id=a6f070e792abfcf8ab6d"></script>

        <script>
    const navMenu = {
        toggle() {
            let menu = document.getElementById('js-nav-menu');
            menu.classList.toggle('hidden');
            menu.classList.toggle('lg:block');
            document.getElementById('js-nav-menu-hide').classList.toggle('hidden');
            document.getElementById('js-nav-menu-show').classList.toggle('hidden');
            console.log(document.getElementById('js-nav-menu2'));
            //document.querySelector("js-nav-menu")
/*
            const menu2 = document.getElementById('js-nav-menu2');
            menu.classList.toggle('hidden');
            menu.classList.toggle('lg:block');
            document.getElementById('js-nav-menu-hide').classList.toggle('hidden');
            document.getElementById('js-nav-menu-show').classList.toggle('hidden');
            */
        },
    }
</script>

        <footer class="bg-white text-center text-sm mt-12 py-4" role="contentinfo">
            <ul class="flex flex-col md:flex-row justify-center list-reset">
                <li class="md:mr-2">
                    &copy; <a href="https://genealabs.com" title="GeneaLabs website">GeneaLabs</a> 2019.
                </li>
            </ul>
        </footer>
    </body>
</html>
